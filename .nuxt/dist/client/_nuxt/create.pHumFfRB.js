import{q as E,C as K,r as i,s as G,o as u,c as f,a as o,b as d,x as b,U as $,v as l,t as w,F as J,y as W,G as j,K as F,M as R,V as Q,z as Y,W as Z}from"./entry.BwfMk_n7.js";import{B as ee}from"./BackIcon.f37TPWn0.js";import{C as te}from"./CloseIcon.CCGiUVmv.js";import{_ as se,a as oe,b as le,c as ae}from"./ChooseCallNumberInput.vue.DBeCVQ6W.js";import ne from"./Loading.DaujwwDc.js";import"./ServiceItem.vue.D0cx6qdD.js";import"./useCustomFetch.CauNvmae.js";import"./fetch.vQosQKJt.js";import"./ArrowUpIcon.DQX1wy99.js";import"./DoneCheckIcon.BMqtvRLi.js";import"./Modal.vue.Cn1Uu0x0.js";import"./CheckBox.vue.jWb8jHHf.js";import"./Auth.D2bTyn-5.js";const re={class:"mt-[20px] w-full flex flex-col items-start justify-start pb-[108px] relative"},ie={class:"w-full relative flex flex-row items-center justify-center py-[23px]"},ce=o("div",{class:"font-semibold text-[16px] text-[#141414] leading-[24px]"},"نمونه کار",-1),pe={class:"w-full flex flex-col my-[21px]"},ue={class:"w-full flex flex-col gap-[12px] px-[14px] border-b border-b-[#A9A7A7]"},de={class:"w-full flex flex-row items-start justify-between gap-[12px]"},me={class:"w-full flex-col justify-start items-start"},fe=o("div",{class:"font-medium text-right text-black text-[16px] leading-[21px]"},"عنوان",-1),xe={class:"w-full text-right text-[#828282] text-[14px] font-medium leading-[21px]"},he=["src"],_e={class:"w-full flex flex-row justify-start items-start gap-[12px] mt-[7px] flex-wrap"},ve=["src"],ge={class:"w-[80px] h-[80px] flex flex-col justify-center items-center px-[10px] absolute top-0 left-0 right-0 bottom-0 bg-[rgba(0,0,0,.5)]"},be={class:"h-[5px] w-full ltr-dir bg-white rounded-[5px] relative"},we={class:"text-center text-white text-[12px] mt-2"},ye={class:"w-full flex flex-row items-start justify-between gap-[12px] mt-[7px]"},ke={class:"w-full flex-col justify-start items-start"},Ce=o("div",{class:"font-medium text-right text-black text-[16px] leading-[21px]"},"افزودن توضیحات",-1),$e={class:"w-full text-right text-[#828282] text-[14px] font-medium leading-[21px]"},je={class:"w-full flex flex-col"},Fe=["disabled"],Re={key:0},Ue={key:1},Me=E({__name:"create",setup(Ae){const c=R(),y=K(),{$postRequest:U}=R(),k=i(),p=i(!1),e=i({title:"",description:"",maintenance:"",service:null,price:0,discount_price:0,has_tel:!1,has_phone_number:!1,second_phone_number:"",images:[]}),m=i([]),x=i([]),h=i([]),_=i([]),v=i([]),A=()=>{y.replace("/panel/artist/portfolios")},V=t=>{e.value.price=t},N=t=>{e.value.discount_price=t},B=t=>{e.value.second_phone_number=t},I=t=>{e.value.has_phone_number=t},P=t=>{e.value.has_tel=t},T=()=>{var t;(t=k.value)==null||t.click()},q=async t=>{var n;x.value=[],m.value=[];const s=(n=t.target)==null?void 0:n.files;if(s.length!=0){for(let r=0;r<s.length;r++){const a=new FileReader;a.onload=()=>{m.value.push(a.result)},a.readAsDataURL(s[r])}x.value=s,await H()}},S=t=>{m.value.splice(t,1),_.value.splice(t,1)},H=async()=>{const t=x.value.length;h.value=Array(t).fill("0%"),_.value=Array(t).fill(null),v.value=Array(t).fill(!0);for(let s=0;s<t;s++)await D(x.value[s],s)},D=async(t,s)=>{const n=Q(),r=new FormData;r.append("file",t),r.append("type","portfolio");const a=new XMLHttpRequest,g=F("XSRF-TOKEN"),M=F("token");a.open("post",n.public.uploadURL,!0),a.withCredentials=!0,a.setRequestHeader("accept","application/json"),a.setRequestHeader("X-Xsrf-Token",g.value),a.setRequestHeader("Authorization",`Bearer ${M.value}`),a.upload.onprogress=function(C){const O=C.loaded/C.total*100;h.value[s]=O+"%"},a.onreadystatechange=function(){a.readyState},a.onload=()=>{a.status===200&&(_.value[s]=JSON.parse(a.responseText),setTimeout(()=>{v.value[s]=!1},1e3))},a.send(r)},L=G(()=>e.value.images.length>0?e.value.images[0]:"/panel/choose-image.png"),z=()=>{let t=!0;return e.value.title||(c.$toast.error("لطفا عنوان نمونه کار را وارد کنید",{rtl:!0}),t=!1),e.value.description||(c.$toast.error("لطفا توضیحات نمونه کار را وارد کنید",{rtl:!0}),t=!1),e.value.service||(c.$toast.error("لطفا دسته بندی نمونه کار را انتخاب کنید",{rtl:!0}),t=!1),e.value.price||(c.$toast.error("لطفا قیمت نمونه کار را وارد کنید",{rtl:!0}),t=!1),m.value.length==0&&(c.$toast.error("لطفا عکس های نمونه کار را انتخاب کنید",{rtl:!0}),t=!1),t},X=async()=>{var s;if(p.value||!z())return;p.value=!0;const t={title:e.value.title,description:e.value.description,maintenance:e.value.maintenance,service_id:(s=e.value.service)==null?void 0:s.id,price:e.value.price,discount_price:e.value.discount_price,has_tel:e.value.has_tel,has_phone_number:e.value.has_phone_number,second_phone_number:e.value.second_phone_number,images:_.value.map(n=>n.url)};U("/own/portfolios",t).then(async n=>{c.$toast.success("نمونه کار با موفقیت ثبت شد"),await y.push("/panel/artist/portfolios")}).catch(n=>{const r=Object.values(n.data.errors);for(const a in r)for(const g in r[a])c.$toast.error(r[a][g],{rtl:!0})}).finally(()=>{p.value=!1})};return(t,s)=>(u(),f("div",re,[o("div",ie,[ce,d(ee,{onClick:A,class:"absolute left-[30px]"})]),o("div",pe,[o("div",ue,[o("div",de,[o("div",me,[fe,b(o("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>l(e).title=n),class:"w-full px-[10px] py-[4px] mx-[10px] mt-[10px] outline-none focus:outline-none text-[16px]",placeholder:"کراتینه مو,کاشت مژه و...",maxlength:"40"},null,512),[[$,l(e).title]]),o("span",xe,"40 / "+w(l(e).title.length),1)]),o("img",{onClick:T,src:l(L),alt:"",class:"w-[80px] h-[80px]"},null,8,he),o("input",{onChange:q,type:"file",hidden:"",multiple:"",accept:"image/png, images/jpeg",ref_key:"galleryChooser",ref:k},null,544)]),o("div",_e,[(u(!0),f(J,null,W(l(m),(n,r)=>(u(),f("div",{class:"relative",key:r},[(u(),Y(te,{key:0,onClick:a=>S(r),class:"absolute top-[-12px] right-[-12px] z-10"},null,8,["onClick"])),o("img",{class:"w-[80px] h-[80px]",src:n,alt:"",onClick:s[1]||(s[1]=()=>{})},null,8,ve),b(o("div",ge,[o("div",be,[o("div",{class:j(`bg-green-300 rounded-[5px] h-[5px] w-[${l(h)[r]}]`)},null,2),o("div",we,w(l(h)[r]),1)])],512),[[Z,l(v)[r]]])]))),128))]),o("div",ye,[o("div",ke,[Ce,b(o("textarea",{"onUpdate:modelValue":s[2]||(s[2]=n=>l(e).description=n),class:"w-full px-[10px] py-[4px] mx-[10px] mt-[10px] outline-none focus:outline-none text-[16px]",placeholder:"کراتینه مو یک روش موثر برای صافی، درخشندگی و شادابی موهای فر ...",maxlength:"200",rows:"2"},`\r
          `,512),[[$,l(e).description]]),o("span",$e,"200 / "+w(l(e).description.length),1)])])]),o("div",je,[d(se,{modelValue:l(e).service,"onUpdate:modelValue":s[3]||(s[3]=n=>l(e).service=n)},null,8,["modelValue"]),d(oe,{modelValue:l(e).maintenance,"onUpdate:modelValue":s[4]||(s[4]=n=>l(e).maintenance=n)},null,8,["modelValue"]),d(le,{"has-tel":l(e).has_tel,"has-phone-number":l(e).has_phone_number,"second-phone-number":l(e).second_phone_number,"onUpdate:hasTel":P,"onUpdate:hasPhoneNumber":I,"onUpdate:secondPhoneNumber":B},null,8,["has-tel","has-phone-number","second-phone-number"]),d(ae,{price:l(e).price,"discount-price":l(e).discount_price,"onUpdate:price":V,"onUpdate:discountPrice":N},null,8,["price","discount-price"])])]),o("button",{onClick:X,disabled:l(p),class:j([[l(p)?" bg-[rgb(177,177,177)]":" bg-[#FF3CA0]"],"absolute bottom-[30px] left-[22px] right-[22px] cursor-pointer font-semibold text-center text-[14px] leading-[22px] flex justify-center items-center text-white bg-[#FF3CA0] mt-[10px] rounded-full h-[44px]"])},[l(p)?(u(),f("span",Re,[d(ne)])):(u(),f("span",Ue," انتشار "))],10,Fe)]))}});export{Me as default};
