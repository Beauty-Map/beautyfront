import{_ as N,o as d,c as p,a as c,q as $,d as V,t as j,r as h,b as i,v as l,z as q,B as A,G as T,C as z,w as H,K as g,M as L}from"./entry.BtNxfFXi.js";import{_ as U,a as F,b as M}from"./BeautyIcon.CeeAJGlM.js";import{_ as P}from"./MainActionButton.vue.C2o5PYNV.js";import{u as b}from"./Drawer.B7PGOG3I.js";import{_ as G}from"./EmailInput.vue.CZF_wAUX.js";import{b as I}from"./OtpForm.vue.QtznO01i.js";import{u as k}from"./useCustomFetch.CTNm-nVq.js";import K from"./Loading.BtJReGTm.js";const J={},Q={class:"flex flex-col justify-center items-center"},W=c("div",{class:"font-medium text-[24px] leading-[37px] text-[#141414] text-center"}," عضویت ",-1),X=c("div",{class:"font-medium text-[13px] leading-[18px] text-[#133C3E] text-center mx-7"}," برای ثبت نام در بیوتی مپ ایمیل خود را وارد کنید ",-1),Y=[W,X];function Z(m,t){return d(),p("div",Q,Y)}const ve=N(J,[["render",Z]]),ee={class:"flex flex-col justify-center items-center"},te=c("div",{class:"font-medium text-[24px] leading-[37px] text-[#141414] text-center"}," کد تایید را وارد کنید ",-1),se={class:"font-medium text-[13px] leading-[18px] text-[#133C3E] text-center mx-7 mt-[15px]"},ae=$({__name:"Header",props:{email:{type:String,default:"",required:!0}},emits:["changeEmail"],setup(m,{emit:t}){const r=t,u=()=>{r("changeEmail")};return(n,e)=>(d(),p("div",ee,[te,c("div",se,[c("span",null,[V(" لطفا کد تاییدی را که به ایمیل "),c("span",null,j(m.email),1),V(" ارسال شده را وارد کنید. "),c("span",{class:"text-[#400842] font-medium underline cursor-pointer",onClick:u},"ویرایش ایمیل")])])]))}}),oe={class:"flex flex-col justify-start items-center mt-[40px]"},le=$({__name:"OtpDrawer",props:{isOpen:{type:Boolean,default:!1}},emits:["changeEmail","resend","validate","close"],setup(m,{emit:t}){const r=t;b();const u=h(""),n=()=>{r("close")},e=()=>{r("resend")},f=_=>{r("validate",_)};return(_,w)=>(d(),p("div",{class:T(["flex flex-col fixed md:hide top-0 bottom-0 px-[17px] overflow-y-scroll w-full duration-700 ease-in-out bg-white z-[99999999]",[m.isOpen?"left-0":"left-[-100%]"]])},[c("div",oe,[i(ae,{email:l(u),onChangeEmail:n},null,8,["email"]),m.isOpen?(d(),q(I,{key:0,onResend:e,onValidate:f})):A("",!0)])],2))}}),re={class:"w-full overflow-y-auto"},ne={key:0},ie={key:1,class:"text-white text-center text-[20px] leading-[30px]"},he=$({__name:"RegisterForm",setup(m){const t=L();z();const r=b(),u=h(!1),n=h(!1),e=h({email:"",password:"",accept_policy:!1}),f=()=>{u.value=!0},_=()=>{u.value=!1},w=()=>{f()},E=()=>{let o=!0;return e.value.email||(t.$toast.error("لطفا ایمیل خود را وارد کنید",{rtl:!0}),o=!1),e.value.password||(t.$toast.error("لطفا پسورد خود را وارد کنید",{rtl:!0}),o=!1),e.value.accept_policy||(t.$toast.error("لطفا تیک گزینه تایید قوانین را بزنید",{rtl:!0}),o=!1),o},D=async()=>{var v;if(n.value||!E())return;n.value=!0;const o=g("referralId",{maxAge:60*60*24*30,path:"/",sameSite:"lax"}),a={email:e.value.email,password:e.value.password,referrer_code:(v=o.value)==null?void 0:v.toString()},{$postRequest:s}=t;s("/auth/register",a).then(async y=>{t.$toast.success("کد ورود با موفقیت ارسال شد",{rtl:!0});const x=g("email");x.value=e.value.email,t.$toast.success("کد ورود با موفقیت ارسال شد",{rtl:!0}),f()}).catch(y=>{const x=Object.values(y.data.errors);for(const C in x)for(const S in x[C])t.$toast.error(x[C][S],{rtl:!0})}).finally(()=>{setTimeout(()=>n.value=!1,500)})},O=()=>{r.closeAllDrawers(),r.openLoginDrawer()},B=async o=>{const a={email:e.value.email,code:o},s=await k("/auth/register/otp",{method:"POST",body:a});s.error.value!=null&&t.$toast.error("کد تایید صحیح نیست",{rtl:!0}),s.data.value!=null&&(t.$toast.success("ایمیل شما تایید شد",{rtl:!0}),_(),r.closeAllDrawers())},R=async o=>{const a={email:e.value.email,password:e.value.password},s=await k("/auth/register",{method:"POST",body:a});if(s.error.value!=null&&t.$toast.error("این ایمیل پیشتر ثبت نام کرده است",{rtl:!0}),s.data.value!=null){const v=g("email");v.value=e.value.email,t.$toast.success("کد ورود با موفقیت ارسال شد",{rtl:!0}),f()}};return(o,a)=>(d(),p("div",re,[i(G,{title:"ایمیل",modelValue:l(e).email,"onUpdate:modelValue":a[0]||(a[0]=s=>l(e).email=s)},null,8,["modelValue"]),i(U,{title:"کلمه عبور",modelValue:l(e).password,"onUpdate:modelValue":a[1]||(a[1]=s=>l(e).password=s),class:"mt-[27px]"},null,8,["modelValue"]),i(F,{class:"mt-[24px]",modelValue:l(e).accept_policy,"onUpdate:modelValue":a[2]||(a[2]=s=>l(e).accept_policy=s)},null,8,["modelValue"]),i(P,{disabled:l(n),class:"mt-[24px]",onClick:D},{default:H(()=>[l(n)?(d(),p("div",ne,[i(K)])):(d(),p("div",ie,"ارسال کد تایید"))]),_:1},8,["disabled"]),i(M,{class:"mt-[18px]",onClick:O,title:"ورود"}),i(le,{"is-open":l(u),onClose:_,onChangeEmail:w,onValidate:B,onResend:R},null,8,["is-open"])]))}});export{ve as H,he as _,le as a};
