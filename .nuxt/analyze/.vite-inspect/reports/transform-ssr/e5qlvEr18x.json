{
  "resolvedId": "/home/saeed/w/projects/beautymap/beautyfront/components/artist-profile-drawer/ArtistAvatar.vue",
  "transforms": [
    {
      "name": "vite:load-fallback",
      "result": "<template>\r\n  <div @click=\"openChooseImage\" class=\"cursor-pointer w-full flex flex-col justify-center items-center\">\r\n    <div class=\"relative w-[153px] h-[153px] rounded-full\">\r\n      <img class=\"w-[153px] h-[153px] rounded-full\" :src=\"tempImage\" alt=\"\" v-if=\"tempImage\"/>\r\n      <img :src=\"avatar\" class=\"w-[153px] h-[153px] rounded-full\" alt=\"\" v-else-if=\"avatar\"/>\r\n      <ProfileBigIcon v-else/>\r\n      <div v-show=\"uploading\" class=\"w-[153px] h-[153px] flex flex-col justify-center items-center px-[10px] rounded-full absolute top-0 left-0 right-0 bottom-0 bg-[rgba(0,0,0,.5)]\">\r\n        <div class=\"h-[5px] w-full ltr-dir bg-white rounded-[5px] relative\">\r\n          <div class=\"bg-green-300 rounded-[5px] h-[5px] w-0\" ref=\"uploadPercentage\"></div>\r\n          <div class=\"text-center text-white text-[12px] mt-2\">{{ getUploadState }}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"text-[#141414] font-semibold text-[16px] leading-[24px] text-center mt-[5px]\">تغییر پروفایل</div>\r\n    <input @change=\"onChooseImage\" accept=\"image/png, image/jpeg\" type=\"file\" hidden ref=\"image\" />\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport ProfileBigIcon from \"~/components/icons/ProfileBigIcon.vue\";\r\nconst props = defineProps({\r\n  avatar: {\r\n    type: String,\r\n    default: null\r\n  },\r\n})\r\nconst emits = defineEmits(['choose'])\r\n\r\nconst uploading = ref(false)\r\nconst uploadState = ref(1)\r\nconst uploadPercentage = ref()\r\nconst image = ref()\r\nconst tempImage = ref<string|null|ArrayBuffer>(null)\r\n\r\nconst getUploadState = computed(() => {\r\n  switch (uploadState.value) {\r\n    case 2:\r\n      return 'آپلود شد';\r\n    case 3:\r\n      return 'آپلود لغو شد';\r\n    default:\r\n      return ''\r\n  }\r\n})\r\nconst openChooseImage = () => {\r\n  image.value?.click()\r\n}\r\n\r\nconst onChooseImage = (e) => {\r\n  const file = e.target?.files[0]\r\n  if (!file) {\r\n    tempImage.value = null\r\n    return\r\n  }\r\n  const reader = new FileReader();\r\n\r\n  reader.onload = () => {\r\n    tempImage.value = reader.result;\r\n  };\r\n\r\n  reader.readAsDataURL(file);\r\n  uploadAvatar(file)\r\n}\r\nconst uploadAvatar = async (file) => {\r\n  const config = useRuntimeConfig()\r\n  uploading.value = true\r\n  const form = new FormData()\r\n  form.append('file', file)\r\n  const xhr = new XMLHttpRequest()\r\n  const xsrf = useCookie('XSRF-TOKEN')\r\n  xhr.open('post', config.public.uploadURL, true)\r\n  xhr.withCredentials = true\r\n  xhr.setRequestHeader('accept', `application/json`)\r\n  xhr.setRequestHeader('X-Xsrf-Token', xsrf.value)\r\n  xhr.upload.onprogress = function (ev) {\r\n    const percentComplete = (ev.loaded / ev.total) * 100;\r\n    uploadPercentage.value.style.width = percentComplete + '%'\r\n  }\r\n  xhr.onreadystatechange = function () {\r\n    if (xhr.readyState === 4) {\r\n\r\n    }\r\n  }\r\n  xhr.onload = () => {\r\n    if (xhr.status === 200) {\r\n      const responseData = JSON.parse(xhr.responseText);\r\n      uploadState.value = 2\r\n      emits('choose', responseData.url)\r\n      setTimeout(() => {\r\n        uploading.value = false\r\n      }, 1000)\r\n    } else {\r\n      uploadState.value = 3\r\n      console.error('Error:', xhr.statusText);\r\n    }\r\n  };\r\n  xhr.send(form)\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>",
      "start": 1726488555939,
      "end": 1726488556116,
      "sourcemaps": null
    },
    {
      "name": "nuxt:layer-aliasing",
      "start": 1726488556116,
      "end": 1726488556116,
      "order": "pre"
    },
    {
      "name": "nuxt:layer-aliasing",
      "start": 1726488556116,
      "end": 1726488556116,
      "order": "pre"
    },
    {
      "name": "nuxt:server-devonly:transform",
      "start": 1726488556116,
      "end": 1726488556116,
      "order": "pre"
    },
    {
      "name": "nuxt:server-devonly:transform",
      "start": 1726488556116,
      "end": 1726488556116,
      "order": "pre"
    },
    {
      "name": "nuxt:client-fallback-auto-id",
      "start": 1726488556116,
      "end": 1726488556116,
      "order": "pre"
    },
    {
      "name": "vite:css",
      "start": 1726488556116,
      "end": 1726488556116,
      "order": "normal"
    },
    {
      "name": "vite:esbuild",
      "start": 1726488556116,
      "end": 1726488556116,
      "order": "normal"
    },
    {
      "name": "vite:json",
      "start": 1726488556116,
      "end": 1726488556116,
      "order": "normal"
    },
    {
      "name": "vite:worker",
      "start": 1726488556116,
      "end": 1726488556116,
      "order": "normal"
    },
    {
      "name": "vite:vue",
      "result": "import _sfc_main from \"/home/saeed/w/projects/beautymap/beautyfront/components/artist-profile-drawer/ArtistAvatar.vue?vue&type=script&setup=true&lang.ts\";\nexport * from \"/home/saeed/w/projects/beautymap/beautyfront/components/artist-profile-drawer/ArtistAvatar.vue?vue&type=script&setup=true&lang.ts\";\nimport { useSSRContext as __vite_useSSRContext } from \"vue\";\nconst _sfc_setup = _sfc_main.setup;\n_sfc_main.setup = (props, ctx) => {\n  const ssrContext = __vite_useSSRContext();\n  (ssrContext.modules || (ssrContext.modules = /* @__PURE__ */ new Set())).add(\"components/artist-profile-drawer/ArtistAvatar.vue\");\n  return _sfc_setup ? _sfc_setup(props, ctx) : void 0;\n};\nexport default _sfc_main;\n",
      "start": 1726488556117,
      "end": 1726488556159,
      "order": "normal",
      "sourcemaps": {
        "mappings": ""
      }
    },
    {
      "name": "vite:vue-jsx",
      "start": 1726488556159,
      "end": 1726488556159,
      "order": "normal"
    },
    {
      "name": "replace",
      "start": 1726488556159,
      "end": 1726488556159,
      "order": "normal"
    },
    {
      "name": "replace",
      "start": 1726488556159,
      "end": 1726488556159,
      "order": "normal"
    },
    {
      "name": "nuxt:remove-plugin-metadata",
      "start": 1726488556159,
      "end": 1726488556159,
      "order": "normal"
    },
    {
      "name": "nuxt:remove-plugin-metadata",
      "start": 1726488556159,
      "end": 1726488556159,
      "order": "normal"
    },
    {
      "name": "nuxt:components:imports",
      "start": 1726488556159,
      "end": 1726488556159,
      "order": "normal"
    },
    {
      "name": "replace",
      "start": 1726488556160,
      "end": 1726488556160,
      "order": "normal"
    },
    {
      "name": "ssr-styles",
      "start": 1726488556160,
      "end": 1726488556160,
      "order": "normal"
    },
    {
      "name": "vite:define",
      "start": 1726488556160,
      "end": 1726488556160,
      "order": "normal"
    },
    {
      "name": "vite:css-post",
      "start": 1726488556160,
      "end": 1726488556160,
      "order": "normal"
    },
    {
      "name": "vite:build-html",
      "start": 1726488556160,
      "end": 1726488556162,
      "order": "normal"
    },
    {
      "name": "vite:worker-import-meta-url",
      "start": 1726488556162,
      "end": 1726488556162,
      "order": "normal"
    },
    {
      "name": "vite:asset-import-meta-url",
      "start": 1726488556162,
      "end": 1726488556162,
      "order": "normal"
    },
    {
      "name": "commonjs",
      "start": 1726488556162,
      "end": 1726488556162,
      "order": "normal"
    },
    {
      "name": "vite:dynamic-import-vars",
      "start": 1726488556162,
      "end": 1726488556162,
      "order": "normal"
    },
    {
      "name": "vite:import-glob",
      "start": 1726488556162,
      "end": 1726488556162,
      "order": "normal"
    },
    {
      "name": "nuxt:composable-keys",
      "start": 1726488556162,
      "end": 1726488556162,
      "order": "post"
    },
    {
      "name": "nuxt:composable-keys",
      "start": 1726488556162,
      "end": 1726488556162,
      "order": "post"
    },
    {
      "name": "nuxt:imports-transform",
      "start": 1726488556162,
      "end": 1726488556164,
      "order": "post"
    },
    {
      "name": "nuxt:imports-transform",
      "start": 1726488556162,
      "end": 1726488556164,
      "order": "post"
    },
    {
      "name": "unctx:transform",
      "start": 1726488556164,
      "end": 1726488556164,
      "order": "post"
    },
    {
      "name": "unctx:transform",
      "start": 1726488556164,
      "end": 1726488556164,
      "order": "post"
    },
    {
      "name": "nuxt:pages-macros-transform",
      "start": 1726488556166,
      "end": 1726488556167,
      "order": "post"
    },
    {
      "name": "nuxt:pages-macros-transform",
      "start": 1726488556166,
      "end": 1726488556167,
      "order": "post"
    },
    {
      "name": "nuxt:tree-shake-template",
      "start": 1726488556170,
      "end": 1726488556170,
      "order": "post"
    },
    {
      "name": "nuxt:components-loader",
      "start": 1726488556171,
      "end": 1726488556171,
      "order": "post"
    },
    {
      "name": "nuxt:tree-shake-composables:transform",
      "start": 1726488556171,
      "end": 1726488556171,
      "order": "post"
    },
    {
      "name": "vite:build-import-analysis",
      "start": 1726488556171,
      "end": 1726488556171,
      "order": "normal"
    },
    {
      "name": "vite:reporter",
      "start": 1726488556171,
      "end": 1726488556172,
      "order": "normal"
    }
  ]
}
