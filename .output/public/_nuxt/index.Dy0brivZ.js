import{q as x,H as B,C as E,r as h,h as g,D as N,E as R,o as l,c as _,a as c,b as r,v as n,J as A,F as H,y as L,z as C,B as z}from"./entry.BtNxfFXi.js";import{u as G}from"./useCustomFetch.CTNm-nVq.js";import{u as q,_ as J}from"./Search.-J60beR4.js";import{F as M,A as k,_ as U}from"./FilterPortfolioDrawer.vue.DQv0dLTo.js";import{S as W,_ as K}from"./SortPortfolioDrawer.vue.8JrJdFHS.js";import{d as w}from"./debounce.BMmXVQ06.js";import{_ as O}from"./PortfolioItem.vue.BCQe0EaN.js";import{W as Q}from"./v3-infinite-loading.es.XhH1FlvR.js";import"./fetch.DJAD9rTR.js";import"./SearchIcon.DNI_2oMJ.js";import"./ArrowUpIcon.PRYG8zVp.js";import"./DoneCheckIcon.BXzjlFpT.js";import"./Rating.vue.C-x5qi5x.js";import"./Tick.vue.CotHSBOy.js";import"./nuxt-link.k4BkbvtB.js";import"./Bookmark.vue.BJUtGWYu.js";import"./Drawer.B7PGOG3I.js";const X={class:"w-full flex flex-col"},Y={class:"w-full flex flex-row items-center justify-start"},Z={class:"w-full flex flex-row gap-[10px] justify-start items-center mt-2 py-2"},ee=c("span",null,"فیلتر",-1),te=c("span",null,"مرتب سازی",-1),oe=x({__name:"PageHeader",setup(v){const o=B(),i=E(),a=h(o.query.term??""),s=q(),p=h(!1),u=h(!1),d=()=>{p.value=!0},y=()=>{p.value=!1},D=async t=>{let e={...o.query};delete e.page,t.id==-1?delete e.services:e.services=t.id.toString(),s.reset(),await i.replace({query:e})},I=()=>{u.value=!0},F=()=>{u.value=!1},$=async t=>{let e={...o.query};switch(delete e.page,t.id){case 1:delete e.order_by,delete e.sort_by;break;case 2:e.order_by="created_at",e.sort_by="desc";break;case 3:e.order_by="price",e.sort_by="asc";break;case 4:e.order_by="price",e.sort_by="desc";break;case 5:e.order_by="discount",e.sort_by="desc";break}s.reset(),await i.replace({query:e})},f=async()=>{var m,b;const t=o.query??{};t.page&&delete t.page,t.page=s.page.toString();const e=await G("/search",{method:"GET",query:t});if(e.data.value){let S=e.data.value?(m=e.data.value)==null?void 0:m.data:[];if(S.length==0){s.showInfiniteScroll=!1;return}s.portfolios=[...s.portfolios,...S],s.lastPage=(b=e.data.value)==null?void 0:b.last_page,setTimeout(()=>{s.showInfiniteScroll=!0},300)}},P=async()=>{let t={...o.query};a.value?t.term=a.value:delete t.term,await i.replace({query:t}),await f()},T=async()=>{await f()},V=w(P,500),j=w(T,500);return g(()=>o.query,f),g(()=>a.value,V),g(()=>s.page,j),N(()=>{R(()=>f())}),(t,e)=>(l(),_("div",X,[c("div",Y,[r(J,{modelValue:n(a),"onUpdate:modelValue":e[0]||(e[0]=m=>A(a)?a.value=m:null)},null,8,["modelValue"])]),c("div",Z,[c("div",{onClick:d,class:"cursor-pointer flex flex-row gap-[4px] justify-start items-center"},[r(M),ee,r(k)]),c("div",{onClick:I,class:"cursor-pointer flex flex-row gap-[4px] justify-start items-center"},[r(W),te,r(k)])]),r(U,{onClose:y,onChoose:D,"is-open":n(p)},null,8,["is-open"]),r(K,{onClose:F,onChoose:$,"is-open":n(u)},null,8,["is-open"])]))}}),se={class:"flex flex-col justify-start items-start"},re=x({__name:"PortfolioSearchList",setup(v){const o=q(),a=w(async()=>{o.page<=o.lastPage&&o.paginate()},500);return(s,p)=>{const u=O;return l(),_("div",se,[(l(!0),_(H,null,L(n(o).portfolios,(d,y)=>(l(),C(u,{key:y,portfolio:d},null,8,["portfolio"]))),128)),n(o).showInfiniteScroll?(l(),C(n(Q),{key:0,firstload:!0,class:"mx-auto",onInfinite:n(a)},null,8,["onInfinite"])):z("",!0)])}}}),ae={class:"flex flex-col px-[23px] py-[10px] h-full w-full"},Se=x({__name:"index",setup(v){return(o,i)=>(l(),_("div",ae,[r(oe,{class:"mb-4"}),r(re)]))}});export{Se as default};
